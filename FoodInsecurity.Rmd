---
title: "FoodInsecurity"
output: pdf_document
---
```{r setup, include=FALSE}
install.packages("readxl")
install.packages("dplyr")
install.packages("ggplot2")
install.packages("tidyverse")
knitr::opts_chunk$set(echo = TRUE)
library("readxl")
library("dplyr")
library("ggplot2")
library("tidyverse")
```
```{r}
variables <- read_excel("food.xlsx",sheet=2)
```
```{r}
variables
```
```{r}
food <- read_excel("food.xlsx",sheet="CA")
food[food=="NULL"]<-"0"
food
```

```{r}
food_filter <- food %>% select(State, County, TractSNAP,Pop2010)
food_filter
```

```{r}
states <- map_data("state")
counties <- map_data("county")
ca_county <- subset(counties, region == "california")
names(food_filter) <- c("State","subregion","TractSNAP","pop","ratio") 
food_filter$subregion <- tolower(food_filter$subregion)
food_filter <- food_filter %>% group_by(subregion)
food_filter <- aggregate(cbind(TractSNAP,pop)~subregion, data=food_filter, FUN=sum)
food_filter$ratio=food_filter$TractSNAP/food_filter$pop
food_filter
```

```{r}
food_filter <- food_filter %>% select(subregion,ratio)
food_filter$subregion = str_remove(food_filter$subregion," county")
graph_county <- inner_join(ca_county,food_filter,by="subregion")
graph_county
```


```{r}
ca_df <- subset(states, region == "california")
ca_base <- ggplot(data = ca_df, mapping = aes(x = long, y = lat, group = group)) + 
  coord_fixed(1.3) + 
  geom_polygon(color = "black", fill = "gray")+ggtitle("Percentage of People on Food Stamps In Each County")
ditch_the_axes <- theme(
  axis.text = element_blank(),
  axis.line = element_blank(),
  axis.ticks = element_blank(),
  panel.border = element_blank(),
  panel.grid = element_blank(),
  axis.title = element_blank()
  )
grapher <- ca_base+ geom_polygon(data=graph_county,aes(fill=ratio),color="white")+ labs(fill = "Percentages")+geom_polygon(color="black",fill=NA)+ditch_the_axes
grapher
```
